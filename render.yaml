# Render Blueprint: https://render.com/docs/blueprint-spec
# Frontend on Vercel: set CORS_ORIGIN to your Vercel URL(s) in Render dashboard.
services:
  - type: web
    name: tic-tac-toe-server
    runtime: node
    rootDir: .
    # Install devDependencies so tsc and @types/* are available for the build
    buildCommand: npm install --include=dev && npm run build
    # Use start.sh so dist/server.js is found even if Render's Root Directory is set to "src"
    startCommand: sh start.sh 2>/dev/null || sh ../start.sh
    envVars:
      - key: NODE_ENV
        value: production
      # Set in Render dashboard:
      # GAMERSTAKE_API_KEY, ENVIRONMENT, CORS_ORIGIN (your Vercel frontend URL)
      # PORT is set automatically by Render
